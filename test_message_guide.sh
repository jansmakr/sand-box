#!/bin/bash

echo "======================================"
echo "메시지 교환 기능 브라우저 테스트 가이드"
echo "======================================"
echo ""

# 서비스 상태 확인
echo "1. 서비스 상태 확인..."
curl -s http://localhost:3000 > /dev/null
if [ $? -eq 0 ]; then
  echo "✅ 서비스가 정상 작동 중입니다."
else
  echo "❌ 서비스가 응답하지 않습니다."
  exit 1
fi
echo ""

echo "======================================"
echo "브라우저 테스트 절차"
echo "======================================"
echo ""

echo "📋 1단계: 고객이 견적 요청 생성"
echo "--------------------------------------"
echo "1) 고객 대시보드 접속: http://localhost:3000/dashboard/customer"
echo "2) 계정: customer@test.com / 1234"
echo "3) 상세 견적 요청 생성 (27개 항목 입력)"
echo "4) 생성된 견적 ID 확인"
echo ""

echo "📋 2단계: 시설이 견적서 전송"
echo "--------------------------------------"
echo "1) 시설 대시보드 접속: http://localhost:3000/dashboard/facility"
echo "2) 계정: hospital@test.com / 1234"
echo "3) 새 견적 요청에서 '견적서 작성' 클릭"
echo "4) 템플릿이 자동 로드됨 확인"
echo "5) 필요한 부분 수정 후 견적서 전송"
echo ""

echo "📋 3단계: 고객이 견적서 확인 및 문의"
echo "--------------------------------------"
echo "1) 고객 대시보드로 돌아가기"
echo "2) 받은 견적서 목록에서 견적서 클릭"
echo "3) 견적서 상세 페이지에서 내용 확인"
echo "4) '문의하기' 버튼 클릭 ⭐ 핵심 기능"
echo "5) 문의 내용 작성:"
echo "   예: 치매 케어 프로그램에 대해 더 자세히 알고 싶습니다."
echo "       입소 가능한 날짜는 언제인가요?"
echo "6) '문의 전송' 버튼 클릭"
echo "7) 전송 완료 메시지 확인"
echo ""

echo "📋 4단계: 시설이 메시지 확인 (향후 구현)"
echo "--------------------------------------"
echo "⚠️  현재는 메시지 전송만 가능합니다."
echo "    향후 추가될 기능:"
echo "    - 시설 대시보드에 '받은 문의' 탭"
echo "    - 문의 메시지 목록 및 상세 보기"
echo "    - 답변 작성 및 전송"
echo "    - 실시간 알림"
echo ""

echo "======================================"
echo "✅ 구현 완료 기능"
echo "======================================"
echo ""
echo "✔ 고객 → 시설 메시지 전송 API"
echo "✔ 견적서 상세 페이지에 '문의하기' 버튼"
echo "✔ 메시지 작성 모달"
echo "✔ 메시지 DB 저장 (chat_messages 테이블)"
echo "✔ 메시지 조회 API"
echo "✔ 시설 답변 API"
echo ""

echo "======================================"
echo "🔧 다음 단계 구현 필요"
echo "======================================"
echo ""
echo "❏ 시설 대시보드에 '받은 문의' UI 추가"
echo "❏ 고객 대시보드에 메시지 내역 표시"
echo "❏ 메시지 읽음 상태 업데이트"
echo "❏ 실시간 알림 (선택사항)"
echo ""

echo "======================================"
echo "테스트 URL"
echo "======================================"
echo ""
echo "🌐 고객 대시보드: http://localhost:3000/dashboard/customer"
echo "🌐 시설 대시보드: http://localhost:3000/dashboard/facility"
echo "🌐 로그인 페이지: http://localhost:3000/login"
echo ""
echo "👤 테스트 계정:"
echo "   고객: customer@test.com / 1234"
echo "   시설: hospital@test.com / 1234"
echo ""
